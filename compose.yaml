version: '3.9'
services:
  accounts:
    image: ca-bh/account:latest
    ports:
      - ${ACCOUNT_SERVICE_PORT}:${ACCOUNT_SERVICE_PORT}
    restart: on-failure
  transactions:
    image: ca-bh/transaction:latest
    ports:
      - ${TRANSACTION_SERVICE_PORT}:${TRANSACTION_SERVICE_PORT}
    restart: on-failure
  balancer:
    image: nginx:latest
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    ports:
      - 5000:5000
    depends_on:
      - transactions
      - accounts
    restart: on-failure
